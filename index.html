<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TuChat ‚Äî Demo</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* ====== ESTILOS MODELOS (RESPETA TU ESTILO) ====== */
.model-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-top:30px;
}
.model-card {
  background:#fff;
  color:#000;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 4px 20px rgba(0,0,0,.1);
  display:flex;
  flex-direction:column;
  cursor:pointer;
  transition:.25s ease;
  animation:floatCard 4s ease-in-out infinite;
}
.model-card:hover{transform:translateY(-2px) scale(1.02)}
@keyframes floatCard{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }
.model-card img {
  width:100%;
  height:280px;
  object-fit:cover;
}
.model-card .info {
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:4px;
}
.model-card .name {
  font-weight:600;
  font-size:16px;
}
.model-card .extra {
  font-size:13px;
  color:#555;
}
.model-card .online {
  display:inline-block;
  background:#27ae60;
  color:#fff;
  font-size:12px;
  padding:2px 6px;
  border-radius:6px;
  margin-left:6px;
}
.model-card .actions{
  display:flex;gap:10px;justify-content:space-between;align-items:center;
  padding:10px;background:#f8f8f8;
}
.model-card .actions .left{
  display:flex;gap:8px;align-items:center;
}
.model-card .actions .right{
  display:flex;gap:8px;align-items:center;
}
.icon-btn{
  display:flex;align-items:center;gap:8px;
  padding:8px 10px;border-radius:10px;border:none;
  background:#eef1f4;color:#222;font-weight:600;cursor:pointer;
  transition:.15s;
}
.icon-btn:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.08)}
.icon-btn img{width:20px;height:20px;display:block}
.like-count{font-size:12px;color:#666}

/* ====== ESTILOS GENERALES ====== */
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;font-family:Poppins,system-ui,sans-serif;background:#0b1220;color:#e9f6ff}
.container{max-width:1100px;margin:0 auto;padding:16px}
.header{position:sticky;top:0;z-index:50;background:rgba(10,18,32,.85);backdrop-filter:blur(6px);border-bottom:1px solid #132338}
.header-inner{display:flex;justify-content:space-between;align-items:center;padding:12px 16px}
.brand{display:flex;align-items:center;gap:10px;font-weight:700}
.dot{width:10px;height:10px;border-radius:50%;background:#ff2e6a;display:inline-block}
.btn{border:0;padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer;transition:.15s;font-size:14px}
.btn:active{transform:translateY(1px)}
.btn-primary{background:#ff2e6a;color:#fff}
.btn-ghost{background:transparent;color:#cfe7ff;border:1px solid #244362}
.input{width:100%;background:#0e192a;color:#d9eeff;border:1px solid #1f3550;border-radius:12px;padding:10px 12px}
.card{background:#0f1a2b;border:1px solid #1b3150;border-radius:18px;padding:16px;box-shadow:0 10px 32px rgba(0,0,0,.35)}
.small{color:#9bc2df;font-size:12px}
.view{display:none}.view.active{display:block}

/* ====== BANNER ====== */
.banner{
  margin-top:12px;border-radius:14px;overflow:hidden;border:1px solid #1b3150
}
.banner img{
  width:100%;height:140px;object-fit:cover;display:block
}

/* ====== CHAT ====== */
.chat-card{height:calc(100vh - 80px);display:flex;flex-direction:column}
.chat-head{display:flex;align-items:center;gap:10px;border-bottom:1px solid #1b3150;padding:10px;background:#0f1a2b}
.chat-body{flex:1;overflow:auto;display:flex;flex-direction:column;gap:8px;padding:10px 2px}
.msg{max-width:70%;padding:10px 14px;border-radius:18px;line-height:1.35;font-size:15px;animation:floatIn .25s ease}
.msg.you{align-self:flex-end;background:#12253c}
.msg.them{align-self:flex-start;background:#0c1728}
.typing{color:#99c7ff;font-size:12px;padding:6px 0;display:none}
.typing.on{display:block}
.chat-input{display:flex;gap:8px;align-items:center;padding:10px;border-top:1px solid #1b3150;background:#0f1a2b}
.chat-input .input{flex:1}
@keyframes floatIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* Reacciones junto al input del chat */
.chat-reactions{display:flex;gap:8px}
.chat-reactions .icon-btn{background:#13263f;color:#cfe7ff;border:1px solid #284a73}

/* ====== MODAL RECARGA ====== */
.modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.55);z-index:1000}
.modal.show{display:grid}
.modal .box{background:#0f1a2b;border:1px solid #1b3150;border-radius:18px;padding:16px;width:min(420px,92vw)}

/* ====== POP PROMO EN CHAT ====== */
.pop-overlay{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.35);z-index:900}
.pop-overlay.show{display:grid}
.pop-card{background:transparent;border:0;animation:popFloat 1.5s ease-in-out infinite}
.pop-card img{width:min(320px,90vw);border-radius:16px;border:2px solid #fff}
@keyframes popFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
</style>
</head>
<body>

<!-- HEADER -->
<header class="header">
  <div class="header-inner container">
    <div class="brand"><span class="dot"></span> TuChat ‚≠ê</div>
    <nav style="display:flex;gap:12px;align-items:center">
      <div>Monedas: <b id="coinsLabel">0</b></div>
      <button class="btn btn-ghost" data-go="chat">Chat</button>
      <button class="btn btn-ghost" data-go="profile">Perfil</button>
    </nav>
  </div>
</header>

<main class="container">
  <!-- LISTA DE MODELOS (Inicio) -->
  <section id="view-chat" class="view active">
    <!-- Banner por URL -->
    <a class="banner" href="https://TU_BANNER_URL" target="_blank" rel="noopener">
      <img src="https://TU_BANNER_URL" alt="Banner">
    </a>

    <h3>Modelos</h3>
    <div class="model-grid" id="chatList"></div>
  </section>

  <!-- CHAT SOLO (Pantalla completa) -->
  <section id="view-conversation" class="view">
    <div class="card chat-card">
      <div class="chat-head">
        <button class="btn btn-ghost" onclick="leaveChat()">‚Üê Volver</button>
        <img id="chatAvatar" src="" style="width:40px;height:40px;border-radius:50%;object-fit:cover">
        <div>
          <div id="chatName"></div>
          <small id="chatStatus" class="small">En l√≠nea</small>
        </div>
      </div>

      <div class="chat-body" id="messages"></div>
      <div class="typing" id="typingHint">Est√° escribiendo‚Ä¶</div>

      <div class="chat-input">
        <div class="chat-reactions">
          <button class="icon-btn" id="btnReactHeart"><img src="https://HEART_ICON_URL" alt="heart">‚ù§Ô∏è</button>
          <button class="icon-btn" id="btnReactMsg"><img src="https://MSG_ICON_URL" alt="msg">üí¨</button>
        </div>
        <input class="input" id="msgText" placeholder="Escribe un mensaje (2 monedas)"/>
        <button class="btn btn-primary" id="btnSend">Enviar</button>
      </div>
    </div>
  </section>

  <!-- PROFILE -->
  <section id="view-profile" class="view">
    <div class="card">
      <h3>Mi perfil</h3>
      <div class="field"><input class="input" id="pAlias" placeholder="Alias"/></div>
      <div class="field"><input class="input" id="pStatus" placeholder="Estado"/></div>
      <button class="btn btn-primary" id="btnSaveProfile">Guardar</button>
    </div>
  </section>
</main>

<!-- MODAL RECARGA -->
<div id="rechargeModal" class="modal">
  <div class="box">
    <h3 style="margin:0 0 6px">Sin monedas üò¢</h3>
    <p class="small">Cada mensaje cuesta <b>2</b> moneditas.</p>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
      <button class="btn btn-primary" id="btnWatchAd">Ver anuncio (+10)</button>
      <button class="btn btn-ghost" id="btnRecharge">Recargar monedas</button>
      <button class="btn btn-ghost" id="btnCloseRecharge">Cerrar</button>
    </div>
  </div>
</div>

<!-- POP PROMO EN CHAT C/ 1 MIN -->
<div id="chatPop" class="pop-overlay">
  <div class="pop-card">
    <a href="https://TU_POP_CHAT_URL" target="_blank" rel="noopener">
      <img src="https://TU_POP_CHAT_URL" alt="Promo">
    </a>
  </div>
</div>

<script>
/* ===== Helpers DB ===== */
const DB={get:(k,f=null)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};
const START_COINS=50, COIN_PER_MSG=2;

if(!DB.get('models'))DB.set('models',[
  {id:'m1',name:'Luna',edad:22,pais:'Venezuela',desc:'Tierna y juguetona',img:'https://picsum.photos/300/400?1'}
]);

/* ===== Router ===== */
const views={chat:'view-chat',profile:'view-profile',conversation:'view-conversation'};
function go(v){Object.values(views).forEach(id=>document.getElementById(id).classList.remove('active'));document.getElementById(views[v]).classList.add('active');}
document.querySelectorAll('[data-go]').forEach(b=>b.onclick=()=>go(b.dataset.go));

/* ===== Sesi√≥n / Monedas ===== */
let session=DB.get('session')||{alias:'Usuario',coins:START_COINS};
DB.set('session',session);
const coinsLabel=document.getElementById('coinsLabel');
function setCoins(v){session.coins=Math.max(0,v);DB.set('session',session);coinsLabel.textContent=session.coins}
function getCoins(){return session.coins}
setCoins(session.coins||START_COINS);

/* ===== Perfil ===== */
document.getElementById('btnSaveProfile').onclick=()=>{session.alias=document.getElementById('pAlias').value||session.alias;DB.set('session',session);alert('Perfil actualizado')};

/* ===== Likes persistentes ===== */
function getLikes(){return DB.get('likes',{})}
function setLikes(obj){DB.set('likes',obj)}
function incLike(id){const l=getLikes();l[id]=(l[id]||0)+1;setLikes(l);return l[id]}

/* ===== Render modelos (cards con reacciones) ===== */
function renderModels(){
  const list=document.getElementById('chatList');list.innerHTML='';
  const likes=getLikes();
  DB.get('models',[]).forEach(m=>{
    const age=m.edad||20, pais=m.pais||'Pa√≠s';
    const card=document.createElement('div');
    card.className='model-card';
    card.innerHTML=`
      <img src="${m.img}" alt="${m.name}">
      <div class="info">
        <div class="name">${m.name} <span class="online">‚óè Online</span></div>
        <div class="extra">${age} a√±os ¬∑ ${pais}</div>
        <div class="small" style="color:#333">${m.desc||''}</div>
      </div>
      <div class="actions" onclick="event.stopPropagation()">
        <div class="left">
          <button class="icon-btn btn-like"><img src="https://cdn-icons-png.flaticon.com/512/833/833472.png" alt=""><span>Me gusta</span></button>
          <span class="like-count" id="lc_${m.id}">${likes[m.id]||0} likes</span>
        </div>
        <div class="right">
          <button class="icon-btn btn-msg"><img src="https://cdn-icons-png.flaticon.com/512/1034/1034124.png" alt=""><span>Mensaje</span></button>
        </div>
      </div>
    `;
    // Like
    card.querySelector('.btn-like').onclick=()=>{ const n=incLike(m.id); document.getElementById('lc_'+m.id).textContent=n+' likes'; };
    // Mensaje -> abrir chat
    card.querySelector('.btn-msg').onclick=()=>openChat(m);
    // Clic en cualquier parte de la card abre chat
    card.addEventListener('click',()=>openChat(m));
    list.appendChild(card);
  });
}
renderModels();

/* ===== Chat ===== */
let currentModel=null;
const messages=document.getElementById('messages'),
      typingHint=document.getElementById('typingHint'),
      chatStatus=document.getElementById('chatStatus'),
      chatAvatar=document.getElementById('chatAvatar'),
      chatName=document.getElementById('chatName');

let chatPopTimer=null;

function leaveChat(){
  // limpiar pop cada minuto
  if(chatPopTimer){clearInterval(chatPopTimer); chatPopTimer=null;}
  document.getElementById('chatPop').classList.remove('show');
  go('chat');
}

function openChat(m){
  currentModel=m;
  chatAvatar.src=m.img;
  chatName.textContent=m.name;
  chatStatus.textContent='En l√≠nea';
  messages.innerHTML=`<div class="msg them">Holi ${session.alias} üíï soy ${m.name}, ¬øquieres jugar?</div>`;
  go('conversation');

  // Pop en chat cada minuto
  if(chatPopTimer){clearInterval(chatPopTimer)}
  chatPopTimer=setInterval(()=>{ document.getElementById('chatPop').classList.add('show'); setTimeout(()=>document.getElementById('chatPop').classList.remove('show'), 8000); }, 60000);
}

function sendOrPrompt(cost=COIN_PER_MSG, payloadFn){
  if(getCoins()<cost){ openRecharge(); return false; }
  setCoins(getCoins()-cost);
  payloadFn && payloadFn();
  return true;
}

/* Enviar texto */
document.getElementById('btnSend').onclick=()=>{
  if(!currentModel) return;
  const val=document.getElementById('msgText').value.trim(); if(!val) return;
  const ok=sendOrPrompt(COIN_PER_MSG, ()=>{
    messages.innerHTML+=`<div class="msg you">${sanitize(val)}</div>`;
    document.getElementById('msgText').value='';
    simulateSeenAndReply();
  });
};

/* Reacciones ‚ù§Ô∏è / üí¨ en chat */
document.getElementById('btnReactHeart').onclick=()=>{
  if(!currentModel) return;
  const ok=sendOrPrompt(COIN_PER_MSG, ()=>{
    messages.innerHTML+=`<div class="msg you">‚ù§Ô∏è</div>`;
    simulateSeenAndReply();
  });
};
document.getElementById('btnReactMsg').onclick=()=>{ document.getElementById('msgText').focus(); };

/* ‚ÄúEst√° escribiendo‚Äù + visto + respuesta en 3s tras ver */
function simulateSeenAndReply(){
  typing(true); // modelo escribiendo
  // visto a los 500ms y respuesta 3s despu√©s
  setTimeout(()=>{
    // (podr√≠amos marcar ‚Äúvisto‚Äù en la √∫ltima burbuja del user si quisieras)
    setTimeout(()=>{
      typing(false);
      messages.innerHTML+=`<div class="msg them">${autoReply()}</div>`;
      messages.scrollTop=messages.scrollHeight;
    }, 3000);
  }, 500);
}

/* Respuestas auto simples */
const AUTO = [
  "Me encanta lo que dices üòç",
  "¬øPrefieres voz o seguir por aqu√≠? üéß",
  "¬°Qu√© interesante! Cu√©ntame m√°s üí¨",
  "Estoy aqu√≠ para ti üíñ",
  "Jajaja, eres muy divertido üòú"
];
function autoReply(){ return AUTO[Math.floor(Math.random()*AUTO.length)]; }
function typing(on){ typingHint.classList.toggle('on', !!on); }

/* ===== Modal recarga ===== */
const rechargeModal=document.getElementById('rechargeModal');
function openRecharge(){rechargeModal.classList.add('show')}
function closeRecharge(){rechargeModal.classList.remove('show')}
document.getElementById('btnCloseRecharge').onclick=closeRecharge;
// Ver anuncio -> abrir pop/link y dar +10 monedas (demo)
document.getElementById('btnWatchAd').onclick=()=>{
  window.open('https://TU_AD_POP_URL','_blank','noopener');
  setCoins(getCoins()+10);
  closeRecharge();
};
// Recargar -> aqu√≠ pones tu flujo real de pago
document.getElementById('btnRecharge').onclick=()=>{ alert('Flujo de recarga (placeholder)'); };

/* ===== Utilidades ===== */
function sanitize(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}

/* ===== Vista inicial ===== */
go('chat');
</script>
</body>
</html>
