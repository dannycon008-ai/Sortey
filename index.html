<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rifas â€” Tu Diamante</title>

  <!-- Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700;800&display=swap" rel="stylesheet">
  <!-- Tel input -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/css/intlTelInput.css" />

  <style>
  :root{
    --bg:#ffffff; 
    --ink:#111827; 
    --muted:#6b7280; 
    --accent:#0A4975;     
    --border:#e5e7eb; 
    --chip:#f3f4f6; 
    --warn:#ef4444;
    --diamond-url: url('https://qu.ax/zcmdn.png');
  }

  body{margin:0; background:var(--bg); color:var(--ink); font-family:"Inter",sans-serif; font-weight:800;}
  .container{max-width:1200px; margin:0 auto; padding:16px; display:flex; flex-direction:column; align-items:center;}

  /* Header */
  .app-title{display:flex; justify-content:center; margin:20px 0 10px;}
  .app-title img{width:140px; height:140px; border-radius:50%; object-fit:cover;}

  /* Progreso */
  .progress-info{display:flex; flex-direction:column; align-items:center; gap:8px; margin:8px 0 20px; width:100%;}
  .bar{height:14px; background:#f3f4f6; border-radius:999px; overflow:hidden; border:1px solid var(--border); width:min(640px,100%);} 
  .bar>span{display:block; height:100%; background:var(--accent); width:0%; transition:width 1s ease-in-out;}
  .progress-stats{color:var(--muted); font-size:14px; font-weight:700; text-align:center;}

  /* Panel */
  .panel{background:#fff; border:1px solid var(--border); border-radius:16px; padding:16px; width:100%; text-align:center; margin-bottom:16px;}
  .panel h2{margin:0 0 12px 0; font-size:28px; text-transform:uppercase; color:var(--accent);}
  .subtle{color:var(--muted); font-size:14px;}

  /* Lista de boletos */
  .square-wrap{
    width:100%; max-width:780px; aspect-ratio:1/1; border:2px solid var(--border);
    border-radius:20px; overflow:hidden; display:flex; margin:0 auto; 
    box-shadow:0 4px 15px rgba(0,0,0,0.08);
  }
  .ticket-grid{display:grid; grid-template-columns: repeat(6,1fr); gap:6px; padding:10px;}
  @media(min-width:480px){ .ticket-grid{ grid-template-columns: repeat(8,1fr);} }
  @media(min-width:768px){ .ticket-grid{ grid-template-columns: repeat(10,1fr);} }
  @media(min-width:1024px){ .ticket-grid{ grid-template-columns: repeat(12,1fr);} }

  .ticket {
    display:flex; align-items:center; justify-content:center;
    aspect-ratio:1/1;
    border:1px solid var(--border);
    border-radius:10px;
    background:#fff;
    font-weight:800;
    font-size: clamp(12px, 2vw, 18px);
    cursor:pointer;
    transition: transform 0.2s ease, background 0.2s ease;
    color:#0A4975;
  }
  .ticket:hover{background:#f0f9ff; transform:scale(1.05);}
  .ticket.selected{background:#dbeafe; border-color:#bfdbfe; transform:scale(0.95);}
  .ticket.sold {
    position: relative;
    background: #e5e7eb;
    color: transparent;
    border: 1px solid #cbd5e1;
    cursor: not-allowed;
  }
  .ticket.sold::after {
    content:"";
    position:absolute;
    inset:0;
    background-image: var(--diamond-url);
    background-size: 70%;
    background-position:center;
    background-repeat:no-repeat;
    opacity:1;
  }

  /* Chips seleccionados */
  .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; justify-content:center;}
  .chip{display:inline-flex; align-items:center; gap:6px; background:var(--chip); border:1px solid var(--border); border-radius:999px; padding:6px 10px; font-weight:800;}
  .chip button{border:none; background:transparent; cursor:pointer; font-size:16px;}

  .totals{display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center; margin-top:10px;}
  .tag{background:#eef2ff; color:#3730a3; border:1px solid #e0e7ff; border-radius:999px; padding:6px 10px;}

  /* Flechas */
  .pagination-bottom {display:flex; justify-content:center; gap:12px; margin-top:12px;}
  .page-btn {width:40px; height:40px; border:none; border-radius:50%; background:#0A4975; color:#fff; font-size:20px; font-weight:bold; cursor:pointer;}
  #pageInfo { font-weight:bold; }

  /* Mis boletos */
  .big-diamonds{display:flex; flex-wrap:wrap; gap:18px; justify-content:center;}
  .big-diamond{width:120px; height:120px; display:flex; align-items:center; justify-content:center;
    color:#fff; font-size:20px; font-weight:800;
    background-image:var(--diamond-url); background-size:cover; background-position:center;
    border-radius:16px; box-shadow:0 8px 18px rgba(0,0,0,.12);
  }

  /* Footer */
  .contact{background:#ffffff; color:#111; border:1px solid var(--border); border-radius:16px; padding:18px; display:grid; gap:14px; justify-items:center;}
  .row{display:flex; gap:14px; justify-content:center;}
  .row a{display:inline-flex; align-items:center; gap:8px; text-decoration:none; color:#111; font-weight:800; border:1px solid var(--border); padding:10px 14px; border-radius:999px;}
  .row img{width:20px; height:20px;}
  </style>
</head>
<body>
  <div class="container">
    <header class="app-title">
      <img src="https://qu.ax/OVJvi.png" alt="Logo redondo">
    </header>

    <!-- Progreso -->
    <section class="progress-info">
      <div class="bar"><span id="soldBar"></span></div>
      <div class="progress-stats">Vendidos: <b id="soldCount">0</b> / 10.000 â€” <b id="soldPct">0%</b></div>
    </section>

    <!-- Lista -->
    <section class="panel">
      <h2>Lista de boletos</h2>
      <div class="square-wrap"><div id="tickets" class="ticket-grid"></div></div>
      <div class="pagination-bottom">
        <button class="page-btn" id="prevPage">Â«</button>
        <span id="pageInfo">Pag: 1/10</span>
        <button class="page-btn" id="nextPage">Â»</button>
      </div>
      <div class="totals">
        <span class="tag">Precio: <b>15 Bs</b></span>
        <span class="tag">Seleccionados: <b id="selCount">0</b></span>
        <span class="tag">Total: <b id="totalAmount">0 Bs</b></span>
        <button id="btnRandom" class="page-btn" title="Generar 3 boletos">ðŸŽ²</button>
      </div>
      <div id="minMsg" class="subtle" style="color:red; display:none;">Compra mÃ­nima 3 boletos.</div>
      <div id="selectedChips" class="chips"></div>
    </section>

    <!-- Mis boletos -->
    <section class="panel" id="myTicketsPanel" style="display:none;">
      <h2>Mis boletos</h2>
      <div id="myDiamonds" class="big-diamonds"></div>
    </section>

    <!-- Verificador -->
    <section class="panel">
      <h2>Verificador de boletos</h2>
      <input id="verifyInput" placeholder="TelÃ©fono o boleto">
      <button id="btnVerify">Verificar</button>
      <div id="verifyOut"></div>
    </section>

    <!-- Contacto -->
    <section class="contact">
      <h3>Contacto</h3>
      <div class="row">
        <a id="waLink" href="#"><img id="waIcon"> WhatsApp</a>
        <a id="fbLink" href="#"><img id="fbIcon"> Facebook</a>
        <a id="igLink" href="#"><img id="igIcon"> Instagram</a>
      </div>
    </section>
  </div>

<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@19.5.6/build/js/intlTelInput.min.js"></script>
<script>
const PRICE = 15, TOTAL=10000, PAGE=1000;
let currentPage=1, selected=new Set();
const soldKey="sold_tickets";

const el=s=>document.querySelector(s);
const pad=n=>n.toString().padStart(4,'0');
const getSold=()=>new Set(JSON.parse(localStorage.getItem(soldKey)||'[]'));
const setSold=s=>localStorage.setItem(soldKey,JSON.stringify([...s]));

function updateProgress(){
  const s=getSold(), pct=Math.round(s.size/TOTAL*100);
  el('#soldBar').style.width=pct+'%';
  el('#soldCount').textContent=s.size;
  el('#soldPct').textContent=pct+'%';
}

function pageRange(p){return[(p-1)*PAGE,p*PAGE-1];}

function renderTickets(){
  const grid=el('#tickets'); grid.innerHTML='';
  const [st,en]=pageRange(currentPage), s=getSold();
  let nums=[]; for(let i=st;i<=en;i++) nums.push(i);
  // mezclar aleatoriamente
  for(let i=nums.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[nums[i],nums[j]]=[nums[j],nums[i]];}
  nums.forEach(n=>{
    const b=document.createElement('div'); b.className='ticket'; b.textContent=pad(n);
    if(s.has(n)){b.classList.add('sold');}
    else if(selected.has(n)){b.classList.add('selected');}
    else{b.onclick=()=>{selected.add(n);renderTickets();renderChips();updateTotals();}}
    grid.appendChild(b);
  });
  el('#pageInfo').textContent=`Pag: ${currentPage}/10`; updateTotals();
}

function renderChips(){
  const box=el('#selectedChips'); box.innerHTML='';
  [...selected].forEach(n=>{
    const c=document.createElement('span'); c.className='chip'; c.textContent=pad(n);
    const x=document.createElement('button'); x.textContent='Ã—'; x.onclick=()=>{selected.delete(n);renderTickets();renderChips();updateTotals();}
    c.appendChild(x); box.appendChild(c);
  });
}

function updateTotals(){
  el('#selCount').textContent=selected.size;
  el('#totalAmount').textContent=selected.size*PRICE+' Bs';
}

function randomPick(c=3){
  const s=getSold(); while(selected.size<c){
    let n=Math.floor(Math.random()*TOTAL); if(!s.has(n)) selected.add(n);
  } renderTickets(); renderChips(); updateTotals();
}

function verify(){
  const raw=el('#verifyInput').value.trim(),s=getSold(),out=el('#verifyOut'); out.innerHTML='';
  if(/^\d{4}$/.test(raw)){
    if(s.has(+raw)) out.textContent="Boleto vendido";
    else out.textContent="Boleto disponible";
  }
}

window.onload=()=>{
  renderTickets(); updateProgress();
  el('#prevPage').onclick=()=>{if(currentPage>1){currentPage--;renderTickets();}};
  el('#nextPage').onclick=()=>{if(currentPage<10){currentPage++;renderTickets();}};
  el('#btnRandom').onclick=()=>randomPick(3);
  el('#btnVerify').onclick=verify;
};
</script>
</body>
</html>
