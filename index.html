<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TuChat ‚Äî Demo</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* ====== ESTILOS MODELOS ====== */
    .model-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:18px;margin-top:18px;}
    .model-card {background:#fff;color:#000;border-radius:14px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.12);display:flex;flex-direction:column;cursor:pointer;transition:transform .25s ease, box-shadow .25s ease;animation:softFloat 4s ease-in-out infinite;}
    .model-card:hover{transform:translateY(-4px) scale(1.02);box-shadow:0 12px 30px rgba(0,0,0,.2)}
    @keyframes softFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
    .model-slideshow { position:relative; height:200px; }
    .model-slideshow img {position:absolute; inset:0; width:100%; height:100%; object-fit:cover;opacity:0; transition:opacity .6s ease;}
    .model-slideshow img.active{opacity:1}
    .model-card .info { padding:12px; display:flex; flex-direction:column; gap:6px; }
    .model-card .name { font-weight:700; font-size:16px; color:#111; }
    .model-card .extra { font-size:12px; color:#555; }
    .model-card .desc  { font-size:13px; color:#333; }
    .model-card .online {display:inline-block;background:#27ae60;color:#fff;font-size:12px;padding:2px 6px;border-radius:6px;margin-left:6px;}
    .model-card .actions{display:flex; gap:10px; justify-content:space-between; align-items:center; padding:10px 12px; background:#f7f9fb; border-top:1px solid #eaeef3;}
    .action-btn{display:flex; align-items:center; gap:8px; padding:8px 12px; border-radius:10px; border:1px solid #e0e6ee; background:#fff; cursor:pointer; transition:.2s; font-weight:600; font-size:13px; color:#222;}
    .action-btn:hover{transform:translateY(-2px); box-shadow:0 6px 16px rgba(0,0,0,.08)}
    .action-btn img{width:18px;height:18px;display:block}
    .like-badge{background:#ff2e6a; color:#fff; font-size:12px; padding:2px 8px; border-radius:999px;}

    /* ====== GENERALES ====== */
    *{box-sizing:border-box}html,body{height:100%}
    body{margin:0;font-family:Poppins,system-ui,sans-serif;background:#0b1220;color:#e9f6ff}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .header{position:sticky;top:0;z-index:50;background:rgba(10,18,32,.85);backdrop-filter:blur(6px);border-bottom:1px solid #132338}
    .header-inner{display:flex;justify-content:space-between;align-items:center;padding:12px 16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .btn{border:0;padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer;transition:.15s;font-size:14px}
    .btn-primary{background:#ff2e6a;color:#fff}
    .btn-ghost{background:transparent;color:#cfe7ff;border:1px solid #244362}
    .input{width:100%;background:#0e192a;color:#d9eeff;border:1px solid #1f3550;border-radius:12px;padding:10px 12px}
    .card{background:#0f1a2b;border:1px solid #1b3150;border-radius:18px;padding:16px;box-shadow:0 10px 32px rgba(0,0,0,.35)}
    .small{color:#9bc2df;font-size:12px}
    .view{display:none}.view.active{display:block}

    /* ====== BANNER VIDEO ====== */
    .banner-wrap { position: relative; margin-top: 8px; }
    .banner-wrap video {width: 100%;max-height: 180px;object-fit: cover;border-radius: 14px;display: block;}
    .live-badge {position: absolute;top: 12px;left: 12px;background: #001f99;color: #fff;font-weight: 700;font-size: 14px;padding: 6px 12px;border-radius: 10px;animation: pulse 1.5s infinite;box-shadow: 0 0 8px rgba(0,0,0,0.4);}
    @keyframes pulse {0% { transform: scale(1); opacity: 1; }50% { transform: scale(1.1); opacity: 0.85; }100% { transform: scale(1); opacity: 1; }}

    /* ====== CHAT MODERNO ====== */
    .chat-card {display:flex;flex-direction:column;background:#0f172a;color:#fff;border-radius:20px;box-shadow:0 8px 25px rgba(0,0,0,.45);overflow:hidden;animation:fadeInUp .35s ease;position:fixed;bottom:20px;right:20px;width:380px;max-height:520px;z-index:1000;}
    @media (max-width: 768px) {.chat-card {top:0;left:0;right:0;bottom:0;width:100%;height:100%;max-height:none;border-radius:0;}}
    @keyframes fadeInUp {from { transform: translateY(40px); opacity: 0; }to { transform: translateY(0); opacity: 1; }}
    .chat-head {display:flex;align-items:center;gap:12px;padding:12px 16px;background:linear-gradient(90deg,#ff2e6a,#ff4f8b);color:#fff;}
    .chat-body {flex:1;padding:14px;overflow-y:auto;background:#0b1220;display:flex;flex-direction:column;}
    .msg {padding:10px 14px;margin:8px 0;border-radius:14px;font-size:14px;max-width:75%;}
    .msg.them {background:#1e293b;align-self:flex-start;}
    .msg.me {background:#ff2e6a;align-self:flex-end;color:#fff;}
    .typing {font-size:12px;color:#94a3b8;font-style:italic;padding:0 14px 8px;}
    .chat-input {display:flex;padding:10px;background:#111827;border-top:1px solid #1f2937;}
    .chat-input input {flex:1;border:none;outline:none;border-radius:12px;padding:10px;margin-right:8px;background:#1e293b;color:#fff;}
    .chat-input button {background:#ff2e6a;border:none;padding:10px 14px;border-radius:12px;color:#fff;font-weight:600;cursor:pointer;transition:.25s;}
    .chat-input button:hover { background:#e11d48; }

    /* ====== LOGIN ====== */
    .login-card {max-width:360px;margin:60px auto;padding:28px;background:#0f172a;border-radius:20px;box-shadow:0 12px 32px rgba(0,0,0,.55);text-align:center;color:#fff;animation:fadeInUp .4s ease;}
    .login-logo {width:90px;margin-bottom:18px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.4);}
    .login-card h2 { font-size:20px;margin-bottom:6px; }
    .login-card p { font-size:14px;margin-bottom:20px;color:#cbd5e1; }
    .form-group { margin-bottom:14px; }
    .login-input {width:100%;padding:12px 14px;font-size:14px;border-radius:12px;border:1px solid #1f3550;background:#0e192a;color:#fff;outline:none;transition:.25s;}
    .login-input:focus {border-color:#ff2e6a;box-shadow:0 0 6px rgba(255,46,106,.6);}
    .btn-login {width:100%;padding:12px;font-size:15px;font-weight:700;border:none;border-radius:14px;background:linear-gradient(90deg,#ff2e6a,#ff4f8b);color:#fff;cursor:pointer;transition:.3s;}
    .btn-login:hover {transform:translateY(-2px);box-shadow:0 8px 20px rgba(255,46,106,.4);}

    /* ====== MODAL RECARGA ====== */
    .recharge-modal {position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:2000;}
    .recharge-modal.active{display:flex;}
    .recharge-card {width:360px;background:#0f172a;color:#fff;border-radius:20px;padding:20px;text-align:center;box-shadow:0 8px 25px rgba(0,0,0,.6);animation:fadeInUp .4s ease;}
    .recharge-options {display:flex;gap:6px;margin:12px 0;}
    .recharge-tab {flex:1;padding:8px;border:none;border-radius:10px;background:#1e293b;color:#fff;cursor:pointer;}
    .recharge-tab.active {background:#ff2e6a;}
    .recharge-box {display:none;margin-top:10px;}
    .recharge-box.active{display:block;}
    .pay-btn {display:block;width:100%;padding:10px;margin:6px 0;border:none;border-radius:12px;background:#ff2e6a;color:#fff;font-weight:600;cursor:pointer;}
    .custom-box {margin-top:12px;text-align:left}
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <div class="header-inner container">
      <div class="brand">
        <!-- Bot√≥n Recargar -->
        <button class="btn btn-primary" onclick="openRecharge()">üí≥ Recargar</button>
        <img id="appLogo" src="https://qu.ax/PyOjt.png" alt="Logo" style="height:36px;border-radius:8px;object-fit:contain">
        <span>ChispaLive</span>
      </div>
      <nav style="display:flex;gap:12px;align-items:center">
        <div>Monedas: <b id="coinsLabel">0</b></div>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- LOGIN -->
    <section id="view-login" class="view active">
      <div class="login-card">
        <img src="https://qu.ax/PyOjt.png" class="login-logo">
        <h2>Bienvenido a <span style="color:#ff2e6a">ChispaLive</span></h2>
        <p>üéÅ Reg√≠strate y recibe <b>20 moneditas</b></p>
        <div class="form-group"><input id="loginName" class="input login-input" placeholder="Nombre completo"></div>
        <div class="form-group"><input id="loginPhone" class="input login-input" placeholder="N√∫mero de tel√©fono"></div>
        <button class="btn-login" onclick="doLogin()">Entrar</button>
      </div>
    </section>

    <!-- MODELOS -->
    <section id="view-chat" class="view">
      <h3>Modelos</h3>
      <div class="model-grid" id="chatList"></div>
    </section>

    <!-- CHAT -->
    <section id="view-conversation" class="view">
      <div class="chat-card">
        <div class="chat-head">
          <button class="btn btn-ghost" type="button" onclick="go('chat')">‚Üê Volver</button>
          <img id="chatAvatar" src="" style="width:40px;height:40px;border-radius:50%;object-fit:cover">
          <div>
            <div id="chatName" class="name"></div>
            <small id="chatStatus" class="small">En l√≠nea</small>
          </div>
        </div>
        <div class="chat-body" id="messages"></div>
        <div class="typing" id="typingHint">Est√° escribiendo‚Ä¶</div>
        <div class="chat-input">
          <input id="msgText" placeholder="Escribe un mensaje (2 monedas)">
          <button id="btnSend">Enviar</button>
        </div>
      </div>
    </section>
  </main>

  <!-- MODAL RECARGA -->
  <div id="rechargeModal" class="recharge-modal">
    <div class="recharge-card">
      <h3>‚ö° Recarga tus moneditas</h3>
      <div class="recharge-options">
        <button class="recharge-tab active" onclick="showRecharge('paypal')">PayPal</button>
        <button class="recharge-tab" onclick="showRecharge('binance')">Binance</button>
        <button class="recharge-tab" onclick="showRecharge('ads')">Ver anuncios</button>
      </div>
      <div id="payPalBox" class="recharge-box active">
        <button class="pay-btn" onclick="window.location.href='https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=TUCORREO_PAYPAL&currency_code=USD&amount=0.50&item_name=50+moneditas'">50 moneditas / 0,50$</button>
        <button class="pay-btn" onclick="window.location.href='https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=TUCORREO_PAYPAL&currency_code=USD&amount=1.00&item_name=100+moneditas'">100 moneditas / 1$</button>
        <button class="pay-btn" onclick="window.location.href='https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=TUCORREO_PAYPAL&currency_code=USD&amount=5.00&item_name=500+moneditas+%2B20+gratis'">500 +20 üéÅ / 5$</button>
        <div class="custom-box">
          <label>Recarga personalizada (m√≠nimo 50):</label>
          <input type="number" id="customCoins" min="50" class="input" placeholder="Ej: 150">
          <button class="btn btn-primary" onclick="customPay()">Recargar</button>
        </div>
      </div>
      <div id="binanceBox" class="recharge-box"><p>üì≤ Escanea QR en Binance para recargar</p></div>
      <div id="adsBox" class="recharge-box"><button class="btn btn-primary" onclick="watchAds()">Ver anuncios y ganar 30 monedas</button></div>
      <button class="btn btn-ghost" onclick="closeRecharge()">Cerrar</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAlWJTeezvz0Xkd363SgN5CnHFbEp8uNQU",
      authDomain: "chispalive-b7ed6.firebaseapp.com",
      projectId: "chispalive-b7ed6",
      storageBucket: "chispalive-b7ed6.appspot.com",
      messagingSenderId: "334811479289",
      appId: "1:334811479289:web:403a2a1b10f7af6704b628",
      measurementId: "G-60ERX1MFT7"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    /* ROUTER */
    const views={login:'view-login',chat:'view-chat',conversation:'view-conversation'};
    function go(v){Object.values(views).forEach(id=>document.getElementById(id).classList.remove('active'));document.getElementById(views[v]).classList.add('active');}
    window.go=go;

    /* LOGIN */
    let coins=0;
    function doLogin(){
      const name=document.getElementById('loginName').value.trim();
      const phone=document.getElementById('loginPhone').value.trim();
      if(!name||!phone){alert("Completa todos los campos");return;}
      coins=20;
      document.getElementById('coinsLabel').textContent=coins;
      go('chat');
      document.getElementById('view-login').classList.remove('active');
      document.getElementById('view-chat').classList.add('active');
    }
    window.doLogin=doLogin;

    /* MODELOS */
    const chatList=document.getElementById('chatList');
    const slidesIntervals={};
    async function renderModels(){
      chatList.innerHTML='';
      const snap = await getDocs(collection(db,"models"));
      snap.forEach(docSnap=>{
        const m={id:docSnap.id,...docSnap.data()};
        const card=document.createElement('div');
        card.className='model-card';
        const slideId='slide_'+m.id;
        card.innerHTML=`
          <div class="model-slideshow" id="${slideId}">
            ${(m.photos||[]).slice(0,5).map((src,i)=>`<img src="${src}" class="${i===0?'active':''}">`).join('')}
          </div>
          <div class="info">
            <div class="name">${m.name} <span class="online">‚óè Online</span></div>
            <div class="extra">${m.age||'‚Äî'} a√±os ¬∑ ${m.country||'‚Äî'}</div>
            <div class="desc">${m.desc||''}</div>
          </div>
          <div class="actions">
            <button class="action-btn btn-like"><img src="https://qu.ax/hlsxX.png"><span>Me gusta</span><span class="like-badge">${m.likes||0}</span></button>
            <button class="action-btn btn-msg"><img src="https://qu.ax/jGSiu.png"><span>Mensaje</span></button>
          </div>`;
        card.querySelector('.btn-msg').onclick=(e)=>{e.stopPropagation();openChatWith(m);};
        card.onclick=()=>openChatWith(m);
        chatList.appendChild(card);
        startSlideshow(slideId);
      });
    }
    function startSlideshow(id){const box=document.getElementById(id); if(!box) return;const imgs=[...box.querySelectorAll('img')]; if(imgs.length<=1) return;let i=0;if(slidesIntervals[id]) clearInterval(slidesIntervals[id]);slidesIntervals[id]=setInterval(()=>{imgs[i].classList.remove('active');i=(i+1)%imgs.length;imgs[i].classList.add('active');},2800);}

    /* CHAT */
    let currentModel=null;
    const messages=document.getElementById('messages');
    const chatName=document.getElementById('chatName');
    const chatAvatar=document.getElementById('chatAvatar');
    function openChatWith(m){
      currentModel=m;
      chatName.textContent=m.name;
      chatAvatar.src=(m.photos&&m.photos[0])||'';
      messages.innerHTML=`<div class="msg them">Holi üíï soy ${m.name}, ¬øquieres jugar?</div>`;
      go('conversation');
    }

    /* ENVIAR MENSAJES Y DESCONTAR */
    document.getElementById('btnSend').onclick=()=>{
      const msgText=document.getElementById('msgText');
      const txt=msgText.value.trim();
      if(!txt) return;
      if(coins<2){openRecharge();return;}
      coins-=2;
      document.getElementById('coinsLabel').textContent=coins;
      messages.innerHTML+=`<div class="msg me">${txt}</div>`;
      msgText.value='';
      if(coins<=0){openRecharge();}
    };

    /* MODAL RECARGA */
    function openRecharge(){document.getElementById('rechargeModal').classList.add('active');}
    function closeRecharge(){document.getElementById('rechargeModal').classList.remove('active');}
    function showRecharge(tab){
      document.querySelectorAll('.recharge-tab').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.recharge-box').forEach(b=>b.classList.remove('active'));
      if(tab==='paypal'){document.querySelector('[onclick*="paypal"]').classList.add('active');document.getElementById('payPalBox').classList.add('active');}
      if(tab==='binance'){document.getElementById('binanceBox').classList.add('active');}
      if(tab==='ads'){document.getElementById('adsBox').classList.add('active');}
    }
    function customPay(){
      const val=parseInt(document.getElementById('customCoins').value);
      if(val>=50){const usd=(val*0.01).toFixed(2);
        window.location.href=`https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=TUCORREO_PAYPAL&currency_code=USD&amount=${usd}&item_name=${val}+moneditas`;
      }else{alert("M√≠nimo 50 moneditas");}
    }
    function watchAds(){coins+=30;document.getElementById('coinsLabel').textContent=coins;closeRecharge();alert("üéâ Has recibido 30 moneditas por ver anuncios");}

    renderModels();
  </script>
</body>
</html>
